<?php

/**
 * Skeleton subclass for performing query and update operations on the 'usuario' table.
 *
 *
 *
 * This class was autogenerated by Propel 1.6.7 on:
 *
 * Fri Sep 20 13:26:47 2013
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    propel.generator.lib.model
 */
class UsuarioQuery extends BaseUsuarioQuery {

    static public function validaUsuario($u, $c) {

        $usuario = UsuarioQuery::create()
                ->filterByUsuario($u)
                ->findOne();

        $msg = null;
        if ($usuario) {
            if ($usuario->getActivo()) {
                if ($usuario->getClave() != $c) {
                    $msg = 'Credenciales invalidas.';
                    $usuario = null;
                }
            } else {
                $msg = 'Usuario no activo.';
                $usuario = null;
            }
        } else {
            $msg = 'Credenciales invalidas.';
        }
        sfContext::getInstance()->getUser()->setFlash('login', $msg);
        return $usuario;
    }

}
